<div class="shell">
  <!-- Header avec animation d'entrée -->
  <header class="header">
    <div class="header-main">
      <h1>
        <span class="logo-orb"></span>
        Élèves
        <span class="student-count" *ngIf="!loading && filtered">
          {{ filtered.length }}
        </span>
      </h1>
      <p>
        Choisissez un élève pour découvrir les tuteurs les plus compatibles via notre algorithme de matching intelligent.
      </p>
    </div>

    <div class="header-actions">
      <div class="header-badge">
        <span class="badge-dot"></span>
        Vue liste · Matching
      </div>
    </div>
  </header>

  <main class="card">
    <!-- Barre de filtres premium -->
    <div class="filters-section">
      <div class="filter-group">
        <div class="search-wrapper">
          <svg class="search-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
            <circle cx="7" cy="7" r="5" stroke="currentColor" stroke-width="1.5"/>
            <path d="M11 11L14 14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
          <input
            type="text"
            class="search-input"
            placeholder="Rechercher un élève par nom…"
            [(ngModel)]="search"
            (ngModelChange)="applyFilter()"
          />
          <span class="search-shortcut" *ngIf="!search">⌘K</span>
        </div>

        <div class="select-wrapper">
          <svg class="select-icon" width="14" height="14" viewBox="0 0 14 14" fill="none">
            <path d="M2 4h10M2 7h7M2 10h4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
          <select class="select-input" [(ngModel)]="levelFilter" (ngModelChange)="applyFilter()">
            <option value="">Tous les niveaux</option>
            <option value="Collège">Collège</option>
            <option value="Lycée">Lycée</option>
            <option value="Terminale">Terminale</option>
          </select>
        </div>
      </div>

      <!-- Indicateur de résultats avec animation -->
      <div class="results-indicator" *ngIf="!loading && filtered">
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
          <circle cx="6" cy="6" r="5" stroke="currentColor" stroke-width="1.5"/>
          <path d="M4 6l1.5 1.5L9 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        {{ filtered.length }} résultat<span *ngIf="filtered.length > 1">s</span>
      </div>
    </div>

    <!-- Loading skeleton -->
    <div class="skeleton-wrapper" *ngIf="loading">
      <div class="skeleton-row" *ngFor="let i of [1,2,3,4,5]">
        <div class="skeleton-cell skeleton-avatar"></div>
        <div class="skeleton-cell skeleton-text"></div>
        <div class="skeleton-cell skeleton-badge"></div>
        <div class="skeleton-cell skeleton-button"></div>
      </div>
    </div>

    <!-- Error state premium -->
    <div *ngIf="error" class="error-state">
      <div class="error-icon">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
          <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="1.5"/>
          <path d="M10 6v4M10 13v.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
      </div>
      <div class="error-content">
        <strong>Une erreur est survenue</strong>
        <span>{{ error }}</span>
      </div>
    </div>

    <!-- Table premium avec hover states -->
    <div class="table-container" *ngIf="!loading">
      <table class="table">
        <thead>
          <tr>
            <th>
              <div class="th-content">
                <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                  <circle cx="6" cy="4" r="2.5" stroke="currentColor" stroke-width="1.2"/>
                  <path d="M2 10c0-2 1.8-3.5 4-3.5s4 1.5 4 3.5" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                </svg>
                Élève
              </div>
            </th>
            <th>
              <div class="th-content">
                <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                  <rect x="2" y="2" width="8" height="8" rx="1.5" stroke="currentColor" stroke-width="1.2"/>
                  <path d="M4 5.5h4M4 7.5h2.5" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                </svg>
                Niveau
              </div>
            </th>
            <th>
              <div class="th-content">
                Action
              </div>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let s of filtered; let i = index" 
              class="table-row"
              [style.animation-delay]="(i * 0.03) + 's'">
            <td>
              <div class="student-cell">
                <div class="student-avatar">
                  {{ s.full_name?.charAt(0) || '?' }}
                </div>
                <span class="student-name">{{ s.full_name }}</span>
              </div>
            </td>
            <td>
              <span class="level-badge" [attr.data-level]="s.level">
                {{ s.level }}
              </span>
            </td>
            <td>
              <button class="action-btn" (click)="goToMatches(s)">
                <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                  <path d="M3 7h8M8 4l3 3-3 3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Voir tuteurs
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Empty state premium -->
    <div
      *ngIf="!loading && filtered && filtered.length === 0 && !error"
      class="empty-state"
    >
      <div class="empty-illustration">
        <svg width="64" height="64" viewBox="0 0 64 64" fill="none">
          <circle cx="32" cy="32" r="28" stroke="#e5e7eb" stroke-width="2" stroke-dasharray="4 4"/>
          <circle cx="32" cy="26" r="8" stroke="#94a3b8" stroke-width="2"/>
          <path d="M16 48c0-8 7.2-14 16-14s16 6 16 14" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </div>
      <h3>Aucun élève trouvé</h3>
      <p>Essayez de modifier vos filtres de recherche ou de niveau.</p>
    </div>
  </main>
</div>
